<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Individual Area Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {margin:0; padding:0; width:100%; height:100%;}
#mapFrame {width:100%; height:100%; border: none;}
#passwordDiv {position:absolute; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center; background:rgba(255,255,255,0.95); z-index:2000;}
#resetBtn {position:fixed; bottom:12px; right:12px; z-index:3000; padding:6px 10px; font-size:12px; border-radius:6px; border:1px solid #999; background:rgba(255,255,255,0.85);}
</style>
</head>
<body>

<div id="passwordDiv">
  <h2>パスワードを入力してください</h2>
  <input type="password" id="passwordInput" placeholder="パスワード">
  <button id="submitBtn">表示</button>
  <div id="msg" style="color:red; margin-top:8px;"></div>
</div>

<iframe id="mapFrame"></iframe>
<button id="resetBtn">表示をリセット</button>

<script>
const correctPassword = "1914";
const params = new URLSearchParams(location.search);
let mid = params.get("mid") || "";

// mid の中に URL が入っていたら、mid 部分だけ抽出
if (mid.includes("google.com/maps/d")) {
  const m = mid.match(/mid=([^&]+)/);
  if (m) mid = m[1];
}

const embedUrl = mid
  ? "https://www.google.com/maps/d/embed?mid=" + encodeURIComponent(mid)
  : "";

const mapFrame = document.getElementById("mapFrame");
const passwordDiv = document.getElementById("passwordDiv");
const passwordInput = document.getElementById("passwordInput");
const submitBtn = document.getElementById("submitBtn");
const msg = document.getElementById("msg");
const resetBtn = document.getElementById("resetBtn");

submitBtn.onclick = () => {
  if (passwordInput.value === correctPassword) {
    passwordDiv.style.display = "none";
    mapFrame.src = embedUrl;
  } else {
    msg.textContent = "パスワードが違います。";
  }
};

resetBtn.onclick = () => {
  const current = mapFrame.src;
  mapFrame.src = "";
  setTimeout(() => mapFrame.src = current, 100);
};
</script>

</body>
</html>
